!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@riim/map-set-polyfill"),require("cellx")):"function"==typeof define&&define.amd?define(["exports","@riim/map-set-polyfill","cellx"],t):t(e.cellxIndexedCollections=e["cellx-indexed-collections"]={},e.mapSetPolyfill,e.cellx)}(this,function(e,t,i){"use strict";function n(e){this._indexesConfig=e&&e.indexes?e.indexes.map(function(e){return"string"==typeof e?{key:e}:e}):[{key:"id",valueGenerator:c}],this._indexes=Object.create(null)}function r(e,t){n.call(this,t),i.ObservableMap.call(this,e,t)}function o(e,t){n.call(this,t),i.ObservableList.call(this,e,t)}var l=i.ObservableCollectionMixin.prototype,s=l._registerValue,a=l._unregisterValue,c=i.Utils.nextUID;n.prototype={_registerValue:function(e){if(e===Object(e))for(var i=this._indexesConfig,n=this._indexes,r=i.length;r;){var o=i[--r],l=o.key,a=n[l]||(n[l]=new t.Map),c=e[l];if(void 0===c){var p=o.valueGenerator;if(p){do{c=p()}while(a.has(c));Object.defineProperty(e,l,{value:c})}}if(void 0!==c){var f=a.get(c);f?f.push(e):a.set(c,[e])}}s.call(this,e)},_unregisterValue:function(e){if(e===Object(e))for(var t=this._indexesConfig,i=this._indexes,n=t.length;n;){var r=t[--n].key,o=e[r];if(void 0!==o){var l=i[r],s=l.get(o);1==s.length?l.delete(o):s.pop()}}a.call(this,e)},clear:function(){this._indexes=Object.create(null),Object.getPrototypeOf(this.constructor.prototype).clear.call(this)}};var p=i.ObservableMap.prototype,f=p.contains,u=p.get;r.prototype=i.Utils.mixin({__proto__:i.ObservableMap.prototype},[n.prototype,{constructor:r,contains:function(e,t){if(void 0!==t){var i=this._indexes[t];return!!i&&i.has(e)}return f.call(this,e)},get:function(e,t){if(void 0===t)return u.call(this,e);var i=this._indexes[t];if(i){var n=i.get(e);return n&&n[n.length-1]}}}]);var d=i.ObservableList.prototype,h=d.contains,v=d.get;o.prototype=i.Utils.mixin({__proto__:i.ObservableList.prototype},[n.prototype,{constructor:o,contains:function(e,t){if(void 0!==t){var i=this._indexes[t];return!!i&&i.has(e)}return h.call(this,e)},get:function(e,t){if(void 0===t)return v.call(this,e);var i=this._indexes[t];if(i){var n=i.get(e);return n&&n[n.length-1]}}}]),e.IndexedCollectionMixin=n,e.IndexedMap=r,e.IndexedList=o,Object.defineProperty(e,"__esModule",{value:!0})});