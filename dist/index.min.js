!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("cellx")):"function"==typeof define&&define.amd?define(["exports","cellx"],t):t(e.cellxIndexedCollections=e["cellx-indexed-collections"]=e.cellxIndexedCollections||{},e.cellx)}(this,function(e,t){"use strict";function i(e){this._indexesConfig=e&&e.indexes?e.indexes.map(function(e){return"string"==typeof e?{key:e}:e}):[{key:"id",valueGenerator:c}],this._indexes=Object.create(null)}function n(e,n){i.call(this,n),t.ObservableMap.call(this,e,n)}function r(e,n){i.call(this,n),t.ObservableList.call(this,e,n)}var o=t.ObservableCollectionMixin.prototype,l=o._registerValue,s=o._unregisterValue,a=t.JS.Map,c=t.Utils.nextUID;i.prototype={_registerValue:function(e){if(e===Object(e))for(var t=this._indexesConfig,i=this._indexes,n=t.length;n;){var r=t[--n],o=r.key,s=i[o]||(i[o]=new a),c=e[o];if(void 0===c){var u=r.valueGenerator;if(u){do{c=u()}while(s.has(c));Object.defineProperty(e,o,{value:c})}}if(void 0!==c){var p=s.get(c);p?p.push(e):s.set(c,[e])}}l.call(this,e)},_unregisterValue:function(e){if(e===Object(e))for(var t=this._indexesConfig,i=this._indexes,n=t.length;n;){var r=t[--n].key,o=e[r];if(void 0!==o){var l=i[r],a=l.get(o);1==a.length?l.delete(o):a.pop()}}s.call(this,e)},clear:function(){this._indexes=Object.create(null),Object.getPrototypeOf(this.constructor.prototype).clear.call(this)}};var u=t.ObservableMap.prototype,p=u.contains,f=u.get;n.prototype=t.Utils.mixin({__proto__:t.ObservableMap.prototype},i.prototype,{constructor:n,contains:function(e,t){if(arguments.length>=2){var i=this._indexes[t];return!!i&&i.has(e)}return p.call(this,e)},get:function(e,t){if(!(arguments.length>=2))return f.call(this,e);var i=this._indexes[t];if(i){var n=i.get(e);return n&&n[n.length-1]}}});var d=t.ObservableList.prototype,h=d.contains,x=d.get;r.prototype=t.Utils.mixin({__proto__:t.ObservableList.prototype},i.prototype,{constructor:r,contains:function(e,t){if(arguments.length>=2){var i=this._indexes[t];return!!i&&i.has(e)}return h.call(this,e)},get:function(e,t){if(!(arguments.length>=2))return x.call(this,e);var i=this._indexes[t];if(i){var n=i.get(e);return n&&n[n.length-1]}}}),e.IndexedCollectionMixin=i,e.IndexedMap=n,e.IndexedList=r,Object.defineProperty(e,"__esModule",{value:!0})});