!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@riim/map-set-polyfill"),require("cellx"),require("@riim/mixin")):"function"==typeof define&&define.amd?define(["exports","@riim/map-set-polyfill","cellx","@riim/mixin"],t):t(e.cellxIndexedCollections=e["cellx-indexed-collections"]={},e.mapSetPolyfill,e.cellx,e.mixin)}(this,function(e,t,i,n){"use strict";function r(e){this._indexesConfig=e&&e.indexes?e.indexes.map(function(e){return"string"==typeof e?{key:e}:e}):[{key:"id",valueGenerator:p}],this._indexes=Object.create(null)}function o(e,t){r.call(this,t),i.ObservableMap.call(this,e,t)}function l(e,t){r.call(this,t),i.ObservableList.call(this,e,t)}var s=i.ObservableCollectionMixin.prototype,a=s._registerValue,c=s._unregisterValue,p=i.Utils.nextUID;r.prototype={_registerValue:function(e){if(e===Object(e))for(var i=this._indexesConfig,n=this._indexes,r=i.length;r;){var o=i[--r],l=o.key,s=n[l]||(n[l]=new t.Map),c=e[l];if(void 0===c){var p=o.valueGenerator;if(p){do{c=p()}while(s.has(c));Object.defineProperty(e,l,{value:c})}}if(void 0!==c){var u=s.get(c);u?u.push(e):s.set(c,[e])}}a.call(this,e)},_unregisterValue:function(e){if(e===Object(e))for(var t=this._indexesConfig,i=this._indexes,n=t.length;n;){var r=t[--n].key,o=e[r];if(void 0!==o){var l=i[r],s=l.get(o);1==s.length?l.delete(o):s.pop()}}c.call(this,e)},clear:function(){this._indexes=Object.create(null),Object.getPrototypeOf(this.constructor.prototype).clear.call(this)}};var u=i.ObservableMap.prototype,f=u.contains,d=u.get;o.prototype=n.mixin({__proto__:i.ObservableMap.prototype},[r.prototype,{constructor:o,contains:function(e,t){if(void 0!==t){var i=this._indexes[t];return!!i&&i.has(e)}return f.call(this,e)},get:function(e,t){if(void 0===t)return d.call(this,e);var i=this._indexes[t];if(i){var n=i.get(e);return n&&n[n.length-1]}}}]);var h=i.ObservableList.prototype,v=h.contains,x=h.get;l.prototype=n.mixin({__proto__:i.ObservableList.prototype},[r.prototype,{constructor:l,contains:function(e,t){if(void 0!==t){var i=this._indexes[t];return!!i&&i.has(e)}return v.call(this,e)},get:function(e,t){if(void 0===t)return x.call(this,e);var i=this._indexes[t];if(i){var n=i.get(e);return n&&n[n.length-1]}}}]),e.IndexedCollectionMixin=r,e.IndexedMap=o,e.IndexedList=l,Object.defineProperty(e,"__esModule",{value:!0})});